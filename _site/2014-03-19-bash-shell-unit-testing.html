<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Test Driven Development in Bash&mdash;Mark Crossfield</title>
      <meta name="viewport" content="width=device-width">

      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/css/syntax.css">

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/css/main.css">

      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/css/responsive.css">

      <!-- Google Fonts -->
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
      <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-352611-12', 'markcrossfield.co.uk');
      ga('require', 'linkid', 'linkid.js');
      ga('send', 'pageview');

    </script>
  </head>
  <body>
    <div class="site">
      <div class="sidebar" id="sidebar">
        <div class="header">
          <a href="/"><img id="logo" src="/images/logo.png" width="128" height="99"></a>
          <span class="tagline">Developer, engineer, trouble maker</span>
        </div>
        <div class="footer">
          <span id="footer-links">
            <a href="/about/" class="footer-link">About Mark</a> <span class="separator">&bull;</span>
            <a href="https://twitter.com/mrmanc" class="footer-link">@mrmanc</a> <span class="separator">&bull;</span>
            <a href="https://github.com/mrmanc" class="footer-link">GitHub</a>
          </span>
        </div>
        <div class="posts">
          <ul class="posts-list">
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-19-bash-shell-unit-testing.html">
                  <span class="post-date">19 Mar 2014</span>
                  Test Driven Development in Bash
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-17-using-os-x-at-work-behind-a-proxy.html">
                  <span class="post-date">17 Mar 2014</span>
                  Using OS X at work behind a proxy
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-16-free-hosting-with-github-pages.html">
                  <span class="post-date">16 Mar 2014</span>
                  Free hosting with Github Pages
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-02-16-thats-no-moon-visualising-go-delivery-pipelines-using-d3-js.html">
                  <span class="post-date">16 Feb 2014</span>
                  That’s no moon: Visualising Go Delivery Pipelines Using D3.js
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013-05-22-saving-the-world-one-dashboard-at-a-time-using-task-scheduler-and-nircmd-and-powercfg.html">
                  <span class="post-date">22 May 2013</span>
                  Saving the world, one dashboard at a time
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-06-26-ascii-graph-pivot-your-standard-out.html">
                  <span class="post-date">26 Jun 2012</span>
                  Ascii Graph—pivot your standard out
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-06-25-simply-measure-anything-with-metriclogster.html">
                  <span class="post-date">25 Jun 2012</span>
                  Simply Measure Anything with MetricLogster
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-05-10-meet-graphite.html">
                  <span class="post-date">10 May 2012</span>
                  Meet Graphite
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-02-15-fast-feedback.html">
                  <span class="post-date">15 Feb 2012</span>
                  Fast Feedback
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-07-31-are-your-pairs-rotating-enough-generate-a-pairing-heat-map.html">
                  <span class="post-date">31 Jul 2011</span>
                  Are your pairs rotating enough? Generate a pairing heat map
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-07-30-automating-vuze-with-dropbox-in-os-x.html">
                  <span class="post-date">30 Jul 2011</span>
                  Automating Vuze with Dropbox (in OS X)
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-06-05-hello.html">
                  <span class="post-date">05 Jun 2011</span>
                  Hello!
                </a>
              </li>
            
          </ul>
        </div>
        <div class="footer">
          <p>Hosted on <a href="http://pages.github.com/">Github Pages</a> using <a href="http://jekyllrb.com/">Jekyll</a> and <a href="http://the-development.github.io/flex/">Flex</a>
        </div>
      </div>
      <div class="content" id="home">
          <div id="sidebar-button">
    <img src="/images/sidebar-button.png" width="32" height="32">
  </div>
  <div id="post-info">
    
    <div id="cover-photo-container">
      <img id="cover-photo" src="/images/tests-passed.png">
    </div>
    
    <div id="info-container">
      <h1 id="title">Test Driven Development in Bash</h1>
      <span id="date">19 March 2014</a>
    </div>
  </div>

  <div class="post">
    <p>I’ve found myself wanting the convenience of some Bash unit testing for the third time, and not wanting to develop yet another set of assertion functions I thought it was about time to find something reusable. I’m looking to do the basic asserts, with some regular expression matching and a sprinkling of <a href="http://c2.com/cgi/wiki?SelfShuntPattern">self shunt</a> (with command interactions intercepted by replacing commands like echo with functions within the scope of the test). I should credit <a href="https://twitter.com/be4zley/">Ross Beazley</a> for starting me off on this approach. This time I’m resisting the temptation to start a new project and thought I’d find something to fork and improve. So here are a few of the projects I found and a bit of analysis.</p>

<p>Desirable features</p>

<ul>
<li>Regular Expression pattern matching</li>
<li>Summary of results</li>
<li>Breakdown of which tests passed/failed</li>
<li>Ability to show results of all assertions in a test (not just the first that failed)</li>
<li>Discovery of test definitions by filename</li>
<li>Color</li>
</ul>

<h2>ShUnit</h2>

<p><a href="http://shunit.sourceforge.net/">Docs</a>, <a href="http://www.sourceforge.net/projects/shunit">Sourceforge</a>
Last updated Dec 2012
Downloaded 376 times in the last year</p>

<p>Whilst I like the summary that this tool gives you, I don’t really like the output as it doesn’t describe failures. Also frankly I’ve struggled to work out what sort of assertions are supported, or how to use it quickly.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">*************** shUnitTest ****************
10 tests to run:
...
================================================
    Test 9: TestOneAssertFailureAndOneAssertSuccessMeanFailure
------------------------------------------------
Assertation Results: E..
================================================
      &quot;This test failed intentionally&quot; failed.
================================================
    Test 10: TestOneDenyFailureAndOneDenySuccessMeanFailure
------------------------------------------------
Assertation Results: E..
================================================
      &quot;This test failed intentionally&quot; failed.
================================================
Results of Suite:
--------------------------------------------------

10 tests run.
  10 tests succeeded.
  No tests failed.

================================================
</code></pre></div>
<h2>shUnit2</h2>

<p><a href="http://shunit2.googlecode.com/svn/trunk/source/2.1/doc/shunit2.html">Docs</a>, <a href="https://github.com/zanshine/shunit2">Github</a>, <a href="https://code.google.com/p/shunit2">Google Code</a>
101 stars on Google Code.
Last updated May 2011</p>

<p>This one looks okay. It roughly equates JUnit and works on a number of platforms (OS X and Cygwin included) and a number of shells (sh, bash, zsh etc). It appears to have been developed by one person and hasn’t been developed since May 2011, but I’m guessing that’s because it’s feature complete for it’s intended purpose.</p>

<p>The following assertions are supported. That just leaves me missing regex support.</p>

<ul>
<li>assertEquals [message] expected actual</li>
<li>assertNotEquals [message] expected actual</li>
<li>assertSame [message] expected actual</li>
<li>assertNotSame [message] unexpected actual</li>
<li>assertNull [message] value</li>
<li>assertNotNull [message] value</li>
<li>assertTrue</li>
</ul>

<p>The output is a bit thin</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">testEquality
testPartyLikeItIs1999
ASSERT:It&#39;s not 1999 :-( expected:&lt;1999&gt; but was:&lt;2014&gt;

Ran 2 tests.

FAILED (failures=1)
</code></pre></div>
<h2>Conclusion</h2>

<p>I’m going to have a go at extending shUnit2 to support regular expressions. More soon!</p>

  </div>
  <div class="colophon">
    <p>
      <span id="pub-date">Published on 19 March 2014</span> <span class="separator">&bull;</span> <a href="/2014-03-19-bash-shell-unit-testing.html">Permalink</a>
    </p>
  </div>


      </div>
    </div>
    <script src="/scripts/responsive.js" type="text/javascript"></script>
  </body>
</html>

<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Are your pairs rotating enough? Generate a pairing heat map&mdash;Mark Crossfield</title>
      <meta name="viewport" content="width=device-width">

      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/css/syntax.css">

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/css/main.css">

      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/css/responsive.css">

      <!-- Google Fonts -->
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
      <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-352611-12', 'markcrossfield.co.uk');
      ga('require', 'linkid', 'linkid.js');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">
      var disqus_developer = 1;
    </script>
  </head>
  <body>
    <div class="site">
      <div class="sidebar" id="sidebar">
        <div class="header">
          <a href="/"><img id="logo" src="/images/logo.png" width="128" height="99"></a>
          <span class="tagline">Developer, engineer, trouble maker</span>
        </div>
        <div class="footer">
          <span id="footer-links">
            <a href="/about/" class="footer-link">About Mark</a> <span class="separator">&bull;</span>
            <a href="https://twitter.com/mrmanc" class="footer-link">@mrmanc</a> <span class="separator">&bull;</span>
            <a href="https://github.com/mrmanc" class="footer-link">GitHub</a>
          </span>
        </div>
        <div class="posts">
          <ul class="posts-list">
            
              <li class="post-link">
                <a class="post-title" href="/2014-05-01-devops-manchester-monitoring-graphite-and-friends.html">
                  <span class="post-date">01 May 2014</span>
                  DevOps Manchester—Graphite and Friends
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-04-07-quality-shell-scripting-static-analysis.html">
                  <span class="post-date">07 Apr 2014</span>
                  Static Analysis of Shell Scripts
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-28-bad-interpreter-use-svn-autoprops-to-stop-committing-windows-line-endings-in-shell-scripts.html">
                  <span class="post-date">28 Mar 2014</span>
                  Bad Interpreter—SVN autoprops save the day
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-27-bash-shell-unit-testing.html">
                  <span class="post-date">27 Mar 2014</span>
                  Test Driven Development in Bash
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-25-bash-dotfiles-bindle.html">
                  <span class="post-date">25 Mar 2014</span>
                  Take your scripts with you
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-17-using-os-x-at-work-behind-a-proxy.html">
                  <span class="post-date">17 Mar 2014</span>
                  Using OS X at work behind a proxy
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-03-16-free-hosting-with-github-pages.html">
                  <span class="post-date">16 Mar 2014</span>
                  Free hosting with Github Pages
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014-02-16-thats-no-moon-visualising-go-delivery-pipelines-using-d3-js.html">
                  <span class="post-date">16 Feb 2014</span>
                  That’s no moon: Visualising Go Delivery Pipelines Using D3.js
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013-05-22-saving-the-world-one-dashboard-at-a-time-using-task-scheduler-and-nircmd-and-powercfg.html">
                  <span class="post-date">22 May 2013</span>
                  Saving the world, one dashboard at a time
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-06-26-ascii-distribution-histogram-pivot-your-standard-out.html">
                  <span class="post-date">26 Jun 2012</span>
                  Ascii Distribution Histogram—pivot your standard out
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-06-25-simply-measure-anything-with-metriclogster.html">
                  <span class="post-date">25 Jun 2012</span>
                  Simply Measure Anything with MetricLogster
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-05-10-meet-graphite.html">
                  <span class="post-date">10 May 2012</span>
                  Meet Graphite
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012-02-15-fast-feedback.html">
                  <span class="post-date">15 Feb 2012</span>
                  Fast Feedback
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-07-31-are-your-pairs-rotating-enough-generate-a-pairing-heat-map.html">
                  <span class="post-date">31 Jul 2011</span>
                  Are your pairs rotating enough? Generate a pairing heat map
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-07-30-automating-vuze-with-dropbox-in-os-x.html">
                  <span class="post-date">30 Jul 2011</span>
                  Automating Vuze with Dropbox (in OS X)
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011-06-05-hello.html">
                  <span class="post-date">05 Jun 2011</span>
                  Hello!
                </a>
              </li>
            
          </ul>
        </div>
        <div class="footer">
          <p>Hosted on <a href="http://pages.github.com/">Github Pages</a> using <a href="http://jekyllrb.com/">Jekyll</a> and <a href="http://the-development.github.io/flex/">Flex</a>
        </div>
      </div>
      <div class="content" id="home">
          <div id="sidebar-button">
    <img src="/images/sidebar-button.png" width="32" height="32">
  </div>
  <div id="post-info">
    
    <div id="cover-photo-container">
      <img id="cover-photo" src="/images/heatmap.jpg">
    </div>
    
    <div id="info-container">
      <h1 id="title">Are your pairs rotating enough? Generate a pairing heat map</h1>
      <span id="date">31 July 2011</a>
    </div>
  </div>

  <div class="post">
    <p>Our team have often expressed in retrospectives that they feel they should rotate more often. In fact, the irregular rotation is often a theme when trying to get to the root cause of bad design decisions and lacking code architecture. In the spirit of self-organisation we have sought not to impose pair rotation on the team, instead encouraging them to retrospect on this themselves and come up with their own scheme. The only limitation we’ve given is that one of the developers should remain on the story in each swap, so that some context is retained.</p>

<p>Initially rotating every day, the team eventually decided to swap on Tuesdays and Thursdays. It doesn’t happen that often though, and I’d be more comfortable seeing a bit more rotation. Sensing a bit of a smell, and wondering if there might be a pattern I decided to mine the data we had in the Subversion commit messages in an attempt to visualise the situation.</p>

<p>Subversion, like most if not all SCMs allows you to comment each revision of the code that you commit. Often organisations impose a standard pattern for these messages using a commit hook on the Subversion server. Whilst we do not do this, we do follow a conventional structure (at least within each project). Consultants who helped us to introduce pairing suggested that both committers be referenced in the messages. So we’ve ended up with something looking like this:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Project: 123: [mark-c, bob-s] #456 Adding a missing test case to exercise the empty case.
</code></pre></div>
<p>Using this exercise as an opportunity to explore Awk a little further than my usual single like examples, I wrote a script to build a two dimensional array indexed by each of the pair members containing the frequency of commit messages for the given pair.</p>

<p>I then copied this data into Excel, the handy novice statistician’s friend, and build a pivot table from the results with columns representing one committer and rows representing the second committer. Using the conditional formatting in Excel 2010 allowed me to quickly colour the cells according to frequency.</p>

<p>So what am I left with? An easy to read heat map of how often people commit with each other. Granted, it’s not a true representation of how often Mark and Bob work together, as it is skewed by the fact that Mark commits more often when he works with Bob, than when he works with Fred.</p>

<p><img src="/images/pairingheatmap.png" alt="Pairing Heatmap"></p>

<p><a href="/files/pairing.pdf">PDF</a></p>

<p>The team were fascinated, as people tend to be with any visualisation. Without drawing too many conclusions I have left the chart visible in the area where developers have their morning standup and organise rotation so we shall see what happens.</p>

<p>I’m not going to speculate too much about why rotation isn’t happening enough - the focus of this article is on working out how often the team swaps. Suffice to say I think there are deeper reasons than just forgetting it’s a Tuesday or being a at a convenient point in development.</p>

<h3>A note about the script:</h3>

<p>I chose Awk because I wanted to get better at parsing log files etc and aggregating data - I’m sure there are much more appropriate technologies. I’ve provided the source. It expects the subversion log to be piped into it on standard input. I suggest that unless you are lucky enough that your commit message format exactly matches ours, you export the Subversion log to a text file to facilitate your adaption of the regexp (because ‘svn log’ can be <em>slow</em>).</p>

<p>In a nutshell it finds interesting lines in the log, extracts the usernames, discards any commits for departed developers, translates the username variations to one name (since variety is the spice of life), increments an array value and summarises the results to standard out in a format you can easily paste into Excel. I’m sure there are better visualisation technologies which you could probably script but I was aiming for the quick and dirty (yet reproducible). I’ve also provided the shell of the spreadsheet that I used.</p>

<p>You should invoke it using ‘svn log | processpairing’ or ‘cat svn.log | processpairing’ if you chose to output the log to a file.</p>

<h3>Ideas for improvement</h3>

<ul>
<li>Scriptable visualisation</li>
<li>Automating it in our pipeline</li>
</ul>

<div class="highlight"><pre><code class="awk"><span class="sr">/^.*\[[a-zA-Z-]+[ ]*,[ ]*[a-zA-Z-]+\].*$/</span> <span class="p">{</span>
  <span class="c1"># split the pair names into array of names</span>
  <span class="kr">split</span><span class="p">(</span><span class="o">$</span><span class="mi">2</span><span class="p">,</span><span class="nx">names</span><span class="p">,</span><span class="s2">&quot;[, ]+&quot;</span><span class="p">);</span>
  <span class="c1"># check whether we are interested in this pair</span>
  <span class="k">if</span> <span class="p">(</span><span class="kr">match</span><span class="p">(</span><span class="nx">names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">namesToIgnore</span><span class="p">)</span> <span class="o">==</span> <span class="nx">false</span> <span class="o">&amp;&amp;</span> <span class="kr">match</span><span class="p">(</span><span class="nx">names</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">namesToIgnore</span><span class="p">)</span> <span class="o">==</span> <span class="nx">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1"># compensate for variety in the names people specify in commit messages</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">in</span> <span class="nx">substitute</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">name1</span><span class="o">=</span><span class="nx">substitute</span><span class="p">[</span><span class="nx">names</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="p">}</span>
    <span class="nx">else</span> <span class="p">{</span>
      <span class="nx">name1</span><span class="o">=</span><span class="nx">names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">names</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">in</span> <span class="nx">substitute</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">name2</span><span class="o">=</span><span class="nx">substitute</span><span class="p">[</span><span class="nx">names</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="p">}</span>
    <span class="nx">else</span> <span class="p">{</span>
      <span class="nx">name2</span><span class="o">=</span><span class="nx">names</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">name1</span> <span class="o">&lt;</span> <span class="nx">name2</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">pairfreq</span><span class="p">[</span><span class="nx">name1</span><span class="p">,</span><span class="nx">name2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">else</span> <span class="p">{</span>
      <span class="nx">pairfreq</span><span class="p">[</span><span class="nx">name2</span><span class="p">,</span><span class="nx">name1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">END</span> <span class="p">{</span>
  <span class="nx">numberOfPairings</span> <span class="o">=</span> <span class="nx">asorti</span><span class="p">(</span><span class="nx">pairfreq</span><span class="p">,</span><span class="nx">pairs</span><span class="p">)</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">pairNumber</span><span class="p">;</span> <span class="nx">pairNumber</span> <span class="o">&lt;=</span> <span class="nx">numberOfPairings</span><span class="p">;</span> <span class="nx">pairNumber</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">split</span><span class="p">(</span><span class="nx">pairs</span><span class="p">[</span><span class="nx">pairNumber</span><span class="p">],</span><span class="nx">pairnames</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="p">);</span>
    <span class="kr">print</span> <span class="s2">&quot;\&quot;&quot;</span><span class="nx">pairnames</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="s2">&quot;\&quot;,\&quot;&quot;</span><span class="nx">pairnames</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="s2">&quot;\&quot;,\&quot;&quot;</span><span class="nx">pairfreq</span><span class="p">[</span><span class="nx">pairs</span><span class="p">[</span><span class="nx">pairNumber</span><span class="p">]]</span><span class="s2">&quot;\&quot;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

  </div>
  <div class="colophon">
    <p>
      <span id="pub-date">Published on 31 July 2011</span> <span class="separator">&bull;</span> <a href="/2011-07-31-are-your-pairs-rotating-enough-generate-a-pairing-heat-map.html">&#8734; Permalink</a>
    </p>
  </div>
  
<div id="disqus-comments">
  <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'markcrossfield'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>




      </div>
    </div>
    <script src="/scripts/responsive.js" type="text/javascript"></script>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'markcrossfield'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
  </body>
</html>

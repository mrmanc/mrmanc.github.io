<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Ascii Graph - pivot your standard out&mdash;Mark Crossfield</title>
      <meta name="viewport" content="width=device-width">

      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/css/syntax.css">

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/css/main.css">

      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/css/responsive.css">

      <!-- Google Fonts -->
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
      <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-352611-12', 'markcrossfield.co.uk');
      ga('require', 'linkid', 'linkid.js');
      ga('send', 'pageview');

    </script>
  </head>
  <body>
    <div class="site">
      <div class="sidebar" id="sidebar">
        <div class="header">
          <a href="/"><img id="logo" src="/images/logo.png" width="128" height="99"></a>
          <span class="tagline">Developer, engineer, trouble maker</span>
        </div>
        <div class="footer">
          <span id="footer-links">
            <a href="/about/" class="footer-link">About Mark</a> <span class="separator">&bull;</span>
            <a href="https://twitter.com/mrmanc" class="footer-link">@mrmanc</a> <span class="separator">&bull;</span>
            <a href="https://github.com/mrmanc" class="footer-link">GitHub</a>
          </span>
        </div>
        <div class="posts">
          <ul class="posts-list">
            
              <li class="post-link">
                <a class="post-title" href="/posts/osx/mac/proxy/2014/03/17/using-osx-at-work-behind-a-proxy.html">
                  <span class="post-date">17 Mar 2014</span>
                  Using OSX at work behind a proxy
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/posts/2014/03/16/free-hosting-with-github-pages.html">
                  <span class="post-date">16 Mar 2014</span>
                  Free hosting with Github Pages
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/continuous%20delivery/development/visualisation/2014/02/16/thats-no-moon-visualising-go-delivery-pipelines-using-d3-js.html">
                  <span class="post-date">16 Feb 2014</span>
                  That’s no moon: Visualising Go Delivery Pipelines Using D3.js
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013/05/22/saving-the-world-one-dashboard-at-a-time-using-task-scheduler-and-nircmd-and-powercfg.html">
                  <span class="post-date">22 May 2013</span>
                  Saving the world, one dashboard at a time
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/development/visualisation/2012/06/26/ascii-graph-pivot-your-standard-out.html">
                  <span class="post-date">26 Jun 2012</span>
                  Ascii Graph - pivot your standard out
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012/06/25/simply-measure-anything-with-metriclogster.html">
                  <span class="post-date">25 Jun 2012</span>
                  Simply Measure Anything with MetricLogster
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/agile/development/performance/visualisation/2012/05/10/meet-graphite.html">
                  <span class="post-date">10 May 2012</span>
                  Meet Graphite
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/agile/development/2012/02/15/fast-feedback.html">
                  <span class="post-date">15 Feb 2012</span>
                  Fast Feedback
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/agile/development/2011/07/31/are-your-pairs-rotating-enough-generate-a-pairing-heat-map.html">
                  <span class="post-date">31 Jul 2011</span>
                  Are your pairs rotating enough? Generate a pairing heat map.
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/life%20hacks/2011/07/30/automating-vuze-with-dropbox-in-os-x.html">
                  <span class="post-date">30 Jul 2011</span>
                  Automating Vuze with Dropbox (in OS X)
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2011/06/05/hello.html">
                  <span class="post-date">05 Jun 2011</span>
                  Hello!
                </a>
              </li>
            
          </ul>
        </div>
        <div class="footer">
          <p>Hosted on <a href="http://pages.github.com/">Github Pages</a> using <a href="http://jekyllrb.com/">Jekyll</a> and <a href="http://the-development.github.io/flex/">Flex</a>
        </div>
      </div>
      <div class="content" id="home">
          <div id="sidebar-button">
    <img src="/images/sidebar-button.png" width="32" height="32">
  </div>
  <div id="post-info">
    
    <div id="cover-photo-container">
      <img id="cover-photo" src="/images/histogram.jpg">
    </div>
    
    <div id="info-container">
      <h1 id="title">Ascii Graph - pivot your standard out</h1>
      <span id="date">26 June 2012</a>
    </div>
  </div>

  <div class="post">
    <p><strong>Update: I’ve rewritten this with more features and better code - <a href="https://github.com/mrmanc/log-ninja#distribution">take a look</a>!</strong><br>
I spend literally hours a week just trawling logs, often wanting to visualise what I’m seeing. Yes, I could faff with Splunk or something else expensive (yes, I know there is a free version), but sometimes I just want to know what a column of response times looks like.</p>

<p>Previously I was quite a fan of using uniq -c for this aggregation, like this:</p>

<p><code>[something outputting lines with one number or some text] | sort | uniq -c | awk &#39;{print $2 &quot; &quot; $1}&#39; | sort -n</code></p>

<p>Which for the UNIX dictionary does this (first two parts just output lines with the length of one word):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">mark$ cat /usr/share/dict/words | awk &#39;{print length($1)}&#39; | sort | uniq -c | awk &#39;{print $2 &quot; &quot; $1}&#39; | sort -n
1 52
2 160
3 1420
4 5272
5 10230
6 17706
7 23869
8 29989
9 32403
10 30878
11 26013
12 20462
13 14939
14 9765
15 5925
16 3377
17 1813
18 842
19 428
20 198
21 82
22 41
23 17
24 5
</code></pre></div>
<p>... which you’ll all appreciate is a pivot table of word lengths in the handy list of words provided with most UNIX systems. First column is the word length, second is the frequency.</p>

<p>Takes a bit of reading doesn’t it?</p>

<p>Better than that would be something graphical. Using my handy distribution script does this:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">mark$ cat /usr/share/dict/words | awk &#39;{print length($1)}&#39; | distribution -v max_width=30
   Value   Height     %ile Histogram
       0        0   0.0000
       1       52   0.0220 #
       2      160   0.0899 #
       3     1420   0.6919 ##
       4     5272   2.9268 #####
       5    10230   7.2637 ##########
       6    17706  14.7698 #################
       7    23869  24.8887 #######################
       8    29989  37.6021 ############################
       9    32403  51.3388 ##############################
      10    30878  64.4290 #############################
      11    26013  75.4568 #########################
      12    20462  84.1313 ###################
      13    14939  90.4645 ##############
      14     9765  94.6042 ##########
      15     5925  97.1160 ######
      16     3377  98.5476 ####
      17     1813  99.3162 ##
      18      842  99.6731 #
      19      428  99.8546 #
      20      198  99.9385 #
      21       82  99.9733 #
      22       41  99.9907 #
      23       17  99.9979 #
      24        5 100.0000 #
</code></pre></div>
<p>That’s pretty right? You remember the <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> don’t you?</p>

<p>It’s even nice enough to work out that you only had 24 records, and so curtailed it’s default of a chart with a height of 55 rows. If you supply more than 55 records it will work out the value of each bar to distribute your records over 55 lines. If you want to reduce the number of lines, or supply a higher maximum you can pass in a max_lines variable. You can also supply a max value to zoom in on the beginning of the chart.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">mark$ cat /usr/share/dict/words | awk &#39;{print length($1)}&#39; | distribution -v max_lines=5 -v max=10 -v max_width=30
   Value   Height     %ile Histogram
       0       52   0.0429 #
       2     1580   1.3476 #
       4    15502  14.1485 ########
       6    41575  48.4794 ####################
       8    62392 100.0000 ##############################
      10        0 100.0000
</code></pre></div>
<p>I haven’t implemented a min value because thinking about that makes my head hurt. If you fancy doing it yourself, let me know so I can use it :)</p>

<p>Issues: Percentiles are wrong (for some interpretations of wrong) when you zoom in or change the max rows.</p>

<p><strong>Get the script: http://bit.ly/log-ninja</strong></p>

<p>Oh, and see Zach Holman’s <a href="https://github.com/holman/spark">Spark</a> tool for another smart command line visualisation of numbers.</p>

<p>Perhaps (following Zach Holman’s example) you want to understand the distribution of earthquake magnitudes in the last week? Simple.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">mark$ curl http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M0.txt  --silent | sed &#39;1d&#39; | cut -d, -f9 | distribution -v max_width=30
   Value   Height     %ile Histogram
       0      274  23.7435 ################
       1      545  70.9705 ##############################
       2      196  87.9549 ###########
       3       45  91.8544 ###
       4       59  96.9671 ####
       5       31  99.6534 ##
       6        4 100.0000 #
</code></pre></div>
<p>Reassuring eh? Just feel lucky you weren’t in one of those 94 +4<a href="http://en.wikipedia.org/wiki/Moment_magnitude_scale">MMS</a> events!</p>

<p>Awk, I &lt;3 you.</p>

  </div>
  <div class="colophon">
    <p>
      <span id="pub-date">Published on 26 June 2012</span> <span class="separator">&bull;</span> <a href="/development/visualisation/2012/06/26/ascii-graph-pivot-your-standard-out.html">Permalink</a>
    </p>
  </div>


      </div>
    </div>
    <script src="/scripts/responsive.js" type="text/javascript"></script>
  </body>
</html>
